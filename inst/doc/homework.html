<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yifei Zhu" />

<meta name="date" content="2023-12-08" />

<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Yifei Zhu</h4>
<h4 class="date">2023-12-08</h4>



<div id="hw0" class="section level1">
<h1>HW0</h1>
<div id="example-1-正弦函数和余弦函数图像" class="section level2">
<h2>Example 1 正弦函数和余弦函数图像</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">length=</span><span class="dv">300</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">sin</span>(x),<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&quot;green&quot;</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Sine function and cosine function image&quot;</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;value of function&quot;</span>,<span class="at">axes =</span> <span class="cn">FALSE</span>)<span class="co">#正弦</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">cos</span>(x),<span class="at">col=</span><span class="st">&quot;yellow&quot;</span>)<span class="co">#余弦</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="at">col =</span><span class="fu">c</span>(<span class="st">&quot;green&quot;</span>,<span class="st">&quot;yellow&quot;</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;sin&quot;</span>,<span class="st">&quot;cos&quot;</span>))<span class="co">#图例</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)<span class="co">#纵坐标</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="at">at=</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>pi,<span class="at">labels =</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">expression</span>(pi<span class="sc">/</span><span class="dv">2</span>),<span class="fu">expression</span>(pi),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">expression</span>(<span class="dv">3</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">2</span>),<span class="fu">expression</span>(<span class="dv">2</span><span class="sc">*</span>pi)))<span class="co">#横坐标</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-2-班级成绩" class="section level2">
<h2>Example 2 班级成绩</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>d1<span class="ot">&lt;-</span><span class="fu">floor</span>(<span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">70</span>,<span class="dv">100</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>d2<span class="ot">&lt;-</span><span class="fu">floor</span>(<span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">70</span>,<span class="dv">100</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>d3<span class="ot">&lt;-</span><span class="fu">floor</span>(<span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">70</span>,<span class="dv">100</span>))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>score<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,d1,d2,d3,d1<span class="sc">+</span>d2<span class="sc">+</span>d3)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(score)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;学号&quot;</span>,<span class="st">&quot;语文&quot;</span>,<span class="st">&quot;数学&quot;</span>,<span class="st">&quot;英语&quot;</span>,<span class="st">&quot;总分&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>score</span></code></pre></div>
<pre><code>##    学号 语文 数学 英语 总分
## 1     1   73   90   79  242
## 2     2   88   86   79  253
## 3     3   88   78   74  240
## 4     4   88   97   71  256
## 5     5   95   78   76  249
## 6     6   89   95   94  278
## 7     7   70   78   85  233
## 8     8   76   78   97  251
## 9     9   89   75   94  258
## 10   10   85   76   71  232</code></pre>
</div>
<div id="example-3-汽车发动机排量与耗油量散点图" class="section level2">
<h2>Example 3 汽车发动机排量与耗油量散点图</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">x=</span>displ,<span class="at">y=</span>hwy,<span class="at">color=</span>class))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="第一题-3.4" class="section level2">
<h2>第一题 3.4</h2>
<p>由于<span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)}\)</span>，因此分布函数<span class="math display">\[F(y)=\int_0^y\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)}dx=\int_0^ye^{-x^2/(2\sigma^2)}d\frac{x^2}{2\sigma^2}\]</span>
令<span class="math inline">\(t=\frac{x^2}{2\sigma^2}\)</span>，则<span class="math display">\[F(y)=\int_0^{\frac{y^2}{2\sigma^2}}e^{-t}dt=1-e^{-\frac{y^2}{2\sigma^2}}\]</span>
则<span class="math display">\[F^{-1}(u)=\sqrt{-2\sigma^2ln(1-u)}\]</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>RL<span class="ot">&lt;-</span><span class="cf">function</span>(sigma){<span class="co">#Rayleigh分布的产生函数</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>当<span class="math inline">\(\sigma=1\)</span>时，随机数直方图及概率密度函数曲线如图所示：</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sig<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">RL</span>(sig),<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Rayleigh(1)&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.7</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,(y<span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
当<span class="math inline">\(\sigma=2\)</span>时，随机数直方图及概率密度函数曲线如图所示：</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sig<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">RL</span>(sig),<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Rayleigh(2)&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,(y<span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
当<span class="math inline">\(\sigma=4\)</span>时，随机数直方图及概率密度函数曲线如图所示：</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sig<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">RL</span>(sig),<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Rayleigh(4)&quot;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.18</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="fl">0.01</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,(y<span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
由此可见，在给定几种<span class="math inline">\(\sigma&gt;0\)</span>的情况下，随机数直方图与概率密度函数曲线均吻合得较好。</p>
</div>
<div id="第二题-3.11" class="section level2">
<h2>第二题 3.11</h2>
<p>混合分布的概率密度函数为<span class="math display">\[f(x)=p_1\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}+(1-p_1)\frac{1}{\sqrt{2\pi}}e^{-\frac{(x-3)^2}{2}}\]</span>
当<span class="math inline">\(p_1=0.75\)</span>时：</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fl">0.75</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(N,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  M[i,<span class="fu">sample</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">size =</span> <span class="dv">1</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,<span class="dv">1</span><span class="sc">-</span>p1))]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">&lt;-</span>x1<span class="sc">*</span>M[,<span class="dv">1</span>]<span class="sc">+</span>x2<span class="sc">*</span>M[,<span class="dv">2</span>]<span class="co">#产生混合正态分布随机数</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x0,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>),<span class="at">main =</span> <span class="st">&quot;p1=0.75&quot;</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">6</span>,<span class="fl">0.01</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,p1<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
观察图像，可以看出图像似乎是双峰混合的。</p>
<p>改变<span class="math inline">\(p_1\)</span>的取值，当<span class="math inline">\(p_1=0.5\)</span>时：</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(N,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  M[i,<span class="fu">sample</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">size =</span> <span class="dv">1</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,<span class="dv">1</span><span class="sc">-</span>p1))]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">&lt;-</span>x1<span class="sc">*</span>M[,<span class="dv">1</span>]<span class="sc">+</span>x2<span class="sc">*</span>M[,<span class="dv">2</span>]<span class="co">#产生混合正态分布随机数</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x0,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>),<span class="at">main =</span> <span class="st">&quot;p1=0.5&quot;</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">6</span>,<span class="fl">0.01</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,p1<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
当<span class="math inline">\(p_1=0.25\)</span>时：</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fl">0.25</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(N,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  M[i,<span class="fu">sample</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">size =</span> <span class="dv">1</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,<span class="dv">1</span><span class="sc">-</span>p1))]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">&lt;-</span>x1<span class="sc">*</span>M[,<span class="dv">1</span>]<span class="sc">+</span>x2<span class="sc">*</span>M[,<span class="dv">2</span>]<span class="co">#产生混合正态分布随机数</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x0,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="at">main =</span> <span class="st">&quot;p1=0.25&quot;</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">6</span>,<span class="fl">0.01</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,p1<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>因此可以推测，当<span class="math inline">\(p_1=0.5\)</span>时，图像会出现双峰的情况。</p>
</div>
<div id="第三题-3.20" class="section level2">
<h2>第三题 3.20</h2>
<p>取泊松分布参数<span class="math inline">\(\lambda=10\)</span>，伽马分布参数<span class="math inline">\(\alpha=0.5\)</span>,<span class="math inline">\(\beta=2\)</span>：</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span><span class="co">#取1000次重复实验</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>X_t<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>Y_1<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">rpois</span>(t,lambda<span class="sc">*</span>t)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N[t],<span class="at">shape =</span> <span class="fl">0.5</span>,<span class="at">rate =</span> <span class="dv">2</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>X_t[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(Y)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>Y_1[i]<span class="ot">&lt;-</span>Y[<span class="dv">1</span>]</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X_t)<span class="co">#E[X(t)]</span></span></code></pre></div>
<pre><code>## [1] 25.13124</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(Y_1)</span></code></pre></div>
<pre><code>## [1] 25.65751</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X_t)<span class="co">#Var(X(t))</span></span></code></pre></div>
<pre><code>## [1] 18.15284</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(Y_1<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 18.08263</code></pre>
<p>观察结果可知，在本次参数的设定下，<span class="math inline">\(E[X(t)]\)</span>与<span class="math inline">\(\lambda tE[Y_1]\)</span>近似相等，<span class="math inline">\(Var(X(t))\)</span>与<span class="math inline">\(\lambda tE[Y_1^2]\)</span>近似相等。</p>
<p>更改参数，取泊松分布参数<span class="math inline">\(\lambda=12\)</span>，伽马分布参数<span class="math inline">\(\alpha=2\)</span>，<span class="math inline">\(\beta=0.3\)</span>：</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">12</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">&lt;-</span><span class="fl">0.3</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span><span class="co">#取1000次重复实验</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>X_t<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>Y_1<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">rpois</span>(t,lambda<span class="sc">*</span>t)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N[t],<span class="at">shape =</span> <span class="fl">0.5</span>,<span class="at">rate =</span> <span class="dv">2</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>X_t[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(Y)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>Y_1[i]<span class="ot">&lt;-</span>Y[<span class="dv">1</span>]</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X_t)<span class="co">#E[X(t)]</span></span></code></pre></div>
<pre><code>## [1] 30.27608</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(Y_1)</span></code></pre></div>
<pre><code>## [1] 30.63235</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X_t)<span class="co">#Var(X(t))</span></span></code></pre></div>
<pre><code>## [1] 22.42302</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(Y_1<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 23.35014</code></pre>
<p>取泊松分布参数<span class="math inline">\(\lambda=5\)</span>，伽马分布参数<span class="math inline">\(\alpha=0.8\)</span>，<span class="math inline">\(\beta=5\)</span>：</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.8</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span><span class="co">#取1000次重复实验</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>X_t<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>Y_1<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">rpois</span>(t,lambda<span class="sc">*</span>t)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N[t],<span class="at">shape =</span> <span class="fl">0.5</span>,<span class="at">rate =</span> <span class="dv">2</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>X_t[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(Y)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>Y_1[i]<span class="ot">&lt;-</span>Y[<span class="dv">1</span>]</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X_t)<span class="co">#E[X(t)]</span></span></code></pre></div>
<pre><code>## [1] 12.59072</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(Y_1)</span></code></pre></div>
<pre><code>## [1] 12.87251</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X_t)<span class="co">#Var(X(t))</span></span></code></pre></div>
<pre><code>## [1] 9.395538</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(Y_1<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 9.435883</code></pre>
<p>取泊松分布参数<span class="math inline">\(\lambda=15\)</span>，伽马分布参数<span class="math inline">\(\alpha=5\)</span>，<span class="math inline">\(\beta=8\)</span>：</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">15</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span><span class="co">#取1000次重复实验</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>X_t<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>Y_1<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">rpois</span>(t,lambda<span class="sc">*</span>t)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N[t],<span class="at">shape =</span> <span class="fl">0.5</span>,<span class="at">rate =</span> <span class="dv">2</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>X_t[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(Y)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>Y_1[i]<span class="ot">&lt;-</span>Y[<span class="dv">1</span>]</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X_t)<span class="co">#E[X(t)]</span></span></code></pre></div>
<pre><code>## [1] 37.58102</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(Y_1)</span></code></pre></div>
<pre><code>## [1] 37.08484</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X_t)<span class="co">#Var(X(t))</span></span></code></pre></div>
<pre><code>## [1] 29.39866</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(Y_1<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 30.06573</code></pre>
<p>综上所述，在多次改变泊松分布与伽马分布参数的情况下，可以观察到<span class="math inline">\(X(10)\)</span>的均值和方差均与理论值近似相等。</p>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="section" class="section level2">
<h2>5.4</h2>
<p>Beta(3,3)的概率密度函数为：<span class="math display">\[f(x;3,3)=\frac{1}{B(3,3)}x^2(1-x)^2\]</span>
其中<span class="math inline">\(B(3,3)=\int_0^1t^2(1-t)^2dt=\frac{1}{30}\)</span>
因此<span class="math display">\[f(x;3,3)=30x^2(1-x)^2\]</span> <span class="math display">\[F(x)=\int_0^x30u^2(1-u)^2du\]</span> 令<span class="math inline">\(y=u/x\)</span>，则<span class="math inline">\(du=xdy\)</span>，且<span class="math display">\[\theta=\int_0^130x^3y^2(1-xy)^2dy\]</span>
因此<span class="math inline">\(\theta=E_Y[30x^3Y^2(1-xY)^2]\)</span></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(m)<span class="co">#Y~U(0,1)</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>cdf<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  g<span class="ot">&lt;-</span><span class="dv">30</span><span class="sc">*</span>x[i]<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x[i]<span class="sc">*</span>u)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  cdf[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(g)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>Phi<span class="ot">&lt;-</span><span class="fu">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(x,cdf,Phi),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9]
## x   0.100 0.200 0.300 0.400 0.500 0.600 0.700 0.800 0.900
## cdf 0.008 0.057 0.162 0.315 0.497 0.680 0.835 0.943 0.995
## Phi 0.009 0.058 0.163 0.317 0.500 0.683 0.837 0.942 0.991</code></pre>
</div>
<div id="section-1" class="section level2">
<h2>5.9</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>RL_sam<span class="ot">&lt;-</span><span class="cf">function</span>(sigma,<span class="at">R=</span><span class="dv">1000</span>,<span class="at">antithetic=</span><span class="cn">TRUE</span>){<span class="co">#服从Rayleigh分布的样本产生函数</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>antithetic){</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    v<span class="ot">&lt;-</span><span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    v<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>u</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">c</span>(u,v)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(x))</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="fu">RL_sam</span>(<span class="dv">2</span>,<span class="at">R=</span><span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## [1] 2.518128</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">RL_sam</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 6.258433</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">RL_sam</span>(<span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>## [1] 0.2510974</code></pre>
<p>取<span class="math inline">\(\sigma=2\)</span></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>MC1<span class="ot">&lt;-</span>MC2<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>sig<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  MC1[i]<span class="ot">&lt;-</span><span class="fu">RL_sam</span>(<span class="at">sigma =</span> sig,<span class="at">R=</span><span class="dv">1000</span>,<span class="at">antithetic =</span> <span class="cn">FALSE</span>)<span class="co">#普通独立抽样</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  MC2[i]<span class="ot">&lt;-</span><span class="fu">RL_sam</span>(<span class="at">sigma =</span> sig,<span class="at">R=</span><span class="dv">1000</span>)<span class="co">#对偶</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(MC1))</span></code></pre></div>
<pre><code>## [1] 0.04136003</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(MC2))</span></code></pre></div>
<pre><code>## [1] 0.009733093</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>((<span class="fu">var</span>(MC1)<span class="sc">-</span><span class="fu">var</span>(MC2))<span class="sc">/</span><span class="fu">var</span>(MC1),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.9446</code></pre>
<p>由此可见，在<span class="math inline">\(\sigma=2\)</span>条件下，使用对偶变量法可以使方差缩减达到94.46%</p>
<p>取<span class="math inline">\(\sigma=0.5\)</span></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>MC1<span class="ot">&lt;-</span>MC2<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>sig<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  MC1[i]<span class="ot">&lt;-</span><span class="fu">RL_sam</span>(<span class="at">sigma =</span> sig,<span class="at">R=</span><span class="dv">1000</span>,<span class="at">antithetic =</span> <span class="cn">FALSE</span>)<span class="co">#普通独立抽样</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  MC2[i]<span class="ot">&lt;-</span><span class="fu">RL_sam</span>(<span class="at">sigma =</span> sig,<span class="at">R=</span><span class="dv">1000</span>)<span class="co">#对偶</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(MC1))</span></code></pre></div>
<pre><code>## [1] 0.01034001</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(MC2))</span></code></pre></div>
<pre><code>## [1] 0.002433273</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>((<span class="fu">var</span>(MC1)<span class="sc">-</span><span class="fu">var</span>(MC2))<span class="sc">/</span><span class="fu">var</span>(MC1),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.9446</code></pre>
<p>由此可见，在<span class="math inline">\(\sigma=0.5\)</span>条件下，使用对偶变量法可以使方差缩减达到94.46%</p>
</div>
<div id="section-2" class="section level2">
<h2>5.13</h2>
<p>选择<span class="math inline">\(f_1=\frac{1}{\sqrt{2\pi}}e^{-x^2/2}\)</span>（标准正态分布）
<span class="math inline">\(f_2=xe^{-x^2/2}\)</span>(Rayleigh(1)分布)</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span>se<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(m)<span class="co">#令f1为重要函数</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dnorm</span>(x)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(fg)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(m)<span class="co">#令f2为重要函数，并使用逆变换法</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span>(x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(fg)</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat,se)</span></code></pre></div>
<pre><code>##               [,1]      [,2]
## theta.hat 0.389357 0.4068302
## se        1.117100 0.3593336</code></pre>
<p>观察结果可知使用重要函数<span class="math inline">\(f_2=xe^{-x^2/2}\)</span>产生的方差更小，原因是<span class="math inline">\(f_2\)</span>与待估计的<span class="math inline">\(g(x)\)</span>更加接近</p>
</div>
<div id="蒙特卡洛实验" class="section level2">
<h2>蒙特卡洛实验</h2>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>time_com<span class="ot">&lt;-</span><span class="cf">function</span>(N){</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>a[i]<span class="ot">&lt;-</span><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">mean</span>(a))</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>t_fun<span class="ot">&lt;-</span><span class="cf">function</span>(n){</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(n<span class="sc">*</span><span class="fu">log</span>(n))</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>an<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">time_com</span>(<span class="fl">1e4</span>),<span class="fu">time_com</span>(<span class="fl">2e4</span>),<span class="fu">time_com</span>(<span class="fl">4e4</span>),<span class="fu">time_com</span>(<span class="fl">6e4</span>),<span class="fu">time_com</span>(<span class="fl">8e4</span>))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>tn<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">t_fun</span>(<span class="fl">1e4</span>),<span class="fu">t_fun</span>(<span class="fl">2e4</span>),<span class="fu">t_fun</span>(<span class="fl">4e4</span>),<span class="fu">t_fun</span>(<span class="fl">6e4</span>),<span class="fu">t_fun</span>(<span class="fl">8e4</span>))</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tn,an)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(an<span class="sc">~</span>tn)<span class="sc">$</span>coef[<span class="dv">1</span>],<span class="fu">lm</span>(an<span class="sc">~</span>tn)<span class="sc">$</span>coef[<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw3" class="section level1">
<h1>HW3</h1>
<div id="第一题6.6" class="section level2">
<h2>第一题6.6</h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>sk<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  sk[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>q_mc<span class="ot">&lt;-</span><span class="fu">quantile</span>(sk,p)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>sd_sk<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  sd_sk[i]<span class="ot">&lt;-</span><span class="fu">sqrt</span>(p[i]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p[i])<span class="sc">/</span>(m<span class="sc">*</span><span class="fu">dnorm</span>(q_mc[i],<span class="dv">0</span>,<span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>m))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>q_mc<span class="co">#蒙特卡洛估计分位数</span></span></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1528197 -0.1280073  0.1304050  0.1481647</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(p,<span class="dv">0</span>,<span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>m))<span class="co">#大样本近似分位数</span></span></code></pre></div>
<pre><code>## [1] -0.1518182 -0.1274098  0.1274098  0.1518182</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>sd_sk<span class="co">#标准差</span></span></code></pre></div>
<pre><code>## [1] 0.006711846 0.005242479 0.005520277 0.005972214</code></pre>
<p>观察结果可知，由蒙特卡洛方法估计出的分位数与大样本近似分位数较为接近。</p>
</div>
<div id="第二题6.b" class="section level2">
<h2>第二题6.B</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, mu, sigma)<span class="co">#产生(X,Y)</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>pearson_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>],data[,<span class="dv">2</span>],<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="co">#Pearson相关系数检验</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>pearson_test<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 1.866227e-06</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>spearman_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>],data[,<span class="dv">2</span>],<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="co">#Spearman秩相关系数检验</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>spearman_test<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 7.933005e-06</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>kendall_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>],data[,<span class="dv">2</span>],<span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="co">#Kendall系数检验</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>kendall_test<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 6.893313e-06</code></pre>
<p>观察结果可知，Pearson相关系数检验的p值最小，即拥有比Spearman秩相关系数检验和Kendall系数检验更好的经验功效。</p>
<p>一个特例：<span class="math inline">\(y=2x^2+e\)</span></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>X0<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>Y0<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>X0<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>pearson_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X0,Y0,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="co">#Pearson相关系数检验</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>pearson_test<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.1105087</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>spearman_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X0,Y0,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="co">#Spearman秩相关系数检验</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>spearman_test<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.1367692</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>kendall_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X0,Y0,<span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="co">#Kendall系数检验</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>kendall_test<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.07689365</code></pre>
<p>在这种情况下，Kendall系数检验的p值最小，即拥有比Pearson相关系数检验更好的经验功效。</p>
</div>
<div id="第三题" class="section level2">
<h2>第三题</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. We want to know if the powers are different at 0.05
level. 1. What is the corresponding hypothesis test problem? 2. What
test should we use? Z-test, two-sample t-test, paired-t-test or McNemar
test? Why? 3. Please provide the least necessary information for
hypothesis testing.</p>
<p>1.对应的假设检验为： <span class="math inline">\(H_0\)</span>：两种方法的功效相同 <span class="math inline">\(H_1\)</span>：两种方法的功效不同</p>
<p>2.应该采用Z检验方法，因为试验次数足够大，且不是配对数据，也不是二分数据。</p>
<p>3.设<span class="math inline">\(p_1=0.651\)</span>，<span class="math inline">\(p_2=0.676\)</span>，则在显著性水平<span class="math inline">\(\alpha=0.05\)</span>下，Z检验统计量为 <span class="math display">\[Z=\frac{p_1-p_2}{\sqrt{p(1-p)(\frac{1}{n_1}+\frac{1}{n_2})}}\]</span></p>
<p>其中：<span class="math inline">\(p=\frac{p_1 + p_2}{2} = \frac{0.651
+ 0.676}{2} = 0.6635\)</span>，<span class="math inline">\(n_1=n_2=10000\)</span> 因此，<span class="math inline">\(Z=\frac{p_1-p_2}{\sqrt{p(1-p)(\frac{1}{n_1}+\frac{1}{n_2})}}
\approx -3.09\)</span></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fl">3.09</span>)</span></code></pre></div>
<pre><code>## [1] 0.001000782</code></pre>
<p>由于p值=0.001，小于显著性水平<span class="math inline">\(\alpha\)</span>（0.05），因此拒绝<span class="math inline">\(H_0\)</span>，并得出结论：在显著性水平为0.05下，两种方法的功效是不同的。</p>
</div>
</div>
<div id="课堂作业" class="section level1">
<h1>课堂作业</h1>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a> d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.961</span>, <span class="fl">0.478</span>, <span class="sc">-</span><span class="fl">0.391</span>, <span class="sc">-</span><span class="fl">0.869</span>, <span class="sc">-</span><span class="fl">0.460</span>, </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span><span class="fl">0.937</span>, <span class="fl">0.779</span>, <span class="sc">-</span><span class="fl">1.409</span>, <span class="fl">0.027</span>, <span class="sc">-</span><span class="fl">1.569</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>d2  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.608</span>, <span class="fl">1.009</span>,  <span class="fl">0.878</span>,  <span class="fl">1.600</span>, <span class="sc">-</span><span class="fl">0.263</span>,  </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>             <span class="fl">0.680</span>, <span class="fl">2.280</span>,  <span class="fl">2.390</span>, <span class="fl">1.793</span>,  <span class="fl">8.091</span>, <span class="fl">1.468</span>)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>mean_d1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(d1)  </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>mean_d2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(d2)  </span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算均值差异  </span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>mean_diff <span class="ot">&lt;-</span> mean_d2 <span class="sc">-</span> mean_d1  </span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算样本标准误差  </span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(d1)  </span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(d2)  </span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>se_diff <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="fu">sd</span>(d1)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> n1) <span class="sc">+</span> (<span class="fu">sd</span>(d2)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> n2))  </span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">10000</span>  </span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>bootstrap_diffs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)  </span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成自助样本并计算均值差异  </span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {  </span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>  d1_bootstrap <span class="ot">&lt;-</span> <span class="fu">sample</span>(d1, <span class="at">replace =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>  d2_bootstrap <span class="ot">&lt;-</span> <span class="fu">sample</span>(d2, <span class="at">replace =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>  mean_d1_bootstrap <span class="ot">&lt;-</span> <span class="fu">mean</span>(d1_bootstrap)  </span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>  mean_d2_bootstrap <span class="ot">&lt;-</span> <span class="fu">mean</span>(d2_bootstrap)  </span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>  bootstrap_diffs[i] <span class="ot">&lt;-</span> mean_d2_bootstrap <span class="sc">-</span> mean_d1_bootstrap  </span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算自助标准误差  </span></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>bootstrap_se_diff <span class="ot">&lt;-</span> <span class="fu">sd</span>(bootstrap_diffs)  </span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias=</span><span class="fu">mean</span>(bootstrap_diffs)<span class="sc">-</span>mean_diff,<span class="at">se.boot=</span>bootstrap_se_diff,<span class="at">se.samp=</span>se_diff),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    bias se.boot se.samp 
##  -0.003   0.708   0.739</code></pre>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
<div id="section-3" class="section level2">
<h2>1.</h2>
<p>Of N = 1000 hypotheses, 950 are null and 50 are alternative. The
p-value under any null hypothesis is uniformly distributed (use runif),
and the p-value under any alternative hypothesis follows the beta
distribution with parameter 0.1 and 1 (use rbeta). Obtain Bonferroni
adjusted p-values and B-H adjusted p-values. Calculate FWER, FDR, and
TPR under nominal level α = 0.1 for each of the two adjustment methods
based on m = 10000 simulation replicates. You should output the 6
numbers (3 ) to a 3 × 2 table (column names: Bonferroni correction, B-H
correction; row names: FWER, FDR, TPR). Comment the results.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">950</span>  <span class="co">#null </span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">50</span>   <span class="co">#alter</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>  </span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>   </span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>fwer_bf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>fdr_bf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  </span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>tpr_bf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  </span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>fwer_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  </span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>fdr_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  </span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>tpr_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  </span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {  </span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#生成p值  </span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(n1), <span class="fu">rbeta</span>(n2, <span class="fl">0.1</span>, <span class="dv">1</span>))  </span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#调整p值  </span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>  bf_adjusted_p_values <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>))  </span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>  bh_adjusted_p_values <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>))  </span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#拒绝  </span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>  bf_rejected <span class="ot">&lt;-</span> bf_adjusted_p_values <span class="sc">&lt;</span> alpha  </span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>  bh_rejected <span class="ot">&lt;-</span> bh_adjusted_p_values <span class="sc">&lt;</span> alpha  </span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 计算FWER, FDR, TPR  </span></span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>  fwer_bf[i] <span class="ot">&lt;-</span> <span class="fu">any</span>(bf_rejected[<span class="dv">1</span><span class="sc">:</span>n1])  </span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>  fdr_bf[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(bf_rejected[<span class="dv">1</span><span class="sc">:</span>n1]) <span class="sc">/</span> <span class="fu">sum</span>(bf_rejected)  </span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>  tpr_bf[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(bf_rejected[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]) <span class="sc">/</span> n2  </span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>  fwer_bh[i] <span class="ot">&lt;-</span> <span class="fu">any</span>(bh_rejected[<span class="dv">1</span><span class="sc">:</span>n1])  </span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>  fdr_bh[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(bh_rejected[<span class="dv">1</span><span class="sc">:</span>n1]) <span class="sc">/</span> <span class="fu">sum</span>(bh_rejected)  </span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>  tpr_bh[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(bh_rejected[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]) <span class="sc">/</span> n2  </span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>fwer_bf_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(fwer_bf)  </span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>fdr_bf_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(fdr_bf)  </span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>tpr_bf_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(tpr_bf)  </span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a>fwer_bh_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(fwer_bh)  </span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>fdr_bh_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(fdr_bh)  </span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>tpr_bh_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(tpr_bh)  </span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(  </span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(fwer_bf_mean, fwer_bh_mean),  </span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(fdr_bf_mean, fdr_bh_mean),  </span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(tpr_bf_mean, tpr_bh_mean)  </span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a>)  </span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>, <span class="st">&quot;BH&quot;</span>)  </span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)  </span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)  </span></code></pre></div>
<pre><code>##       Bonferroni         BH
## FWER 0.091000000 0.93330000
## FDR  0.004643915 0.09442065
## TPR  0.398562000 0.56312400</code></pre>
<p>FWER：Bonferroni方法的FWER小于显著性水平0.1。B-H方法则相对不那么保守，它的FWER明显更大。</p>
<p>FDR：两种方法都小于显著性水平0.1</p>
<p>TPR：Bonferroni方法的TPR较低，表明它在保持低FDR的同时，可能会错过一些真正的效应。B-H方法则能发现更多的真正备择假设，因此其TPR更高。</p>
</div>
<div id="section-4" class="section level2">
<h2>2.</h2>
<p>由于故障间隔时间服从<span class="math inline">\(Exp(\lambda)\)</span>分布，因此其概率密度函数为<span class="math inline">\(f(t)=\lambda e^{-\lambda t}\)</span>
在给定数据<span class="math inline">\(x_1,\ldots,x_n\)</span>下，似然函数为<span class="math display">\[L(\lambda)=\prod_{i=1}^n f(x_i)=\prod_{i=1}^n
\lambda e^{-\lambda x_i}=\lambda e^{-\lambda \sum_{i=1}^n x_i}\]</span>
对数似然函数为<span class="math display">\[l(\lambda)=nln(\lambda)-\lambda \sum_{i=1}^n
x_i\]</span> <span class="math display">\[\frac{\partial
l(\lambda)}{\partial \lambda}=\frac{n}{\lambda}-\sum_{i=1}^n
x_i=0\]</span> <span class="math display">\[\hat{\lambda}=\frac{n}{\sum_{i=1}^n
x_i}\]</span></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">as.vector</span>(aircondit<span class="sc">$</span>hours)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co">#极大似然函数 </span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>mle_lambda <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) { </span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(data[indices])  </span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(n <span class="sc">/</span> <span class="fu">sum</span>(data[indices]))  </span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>obj<span class="ot">&lt;-</span><span class="fu">boot</span>(data,<span class="at">statistic =</span> mle_lambda,<span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>obj</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = data, statistic = mle_lambda, R = 10000)
## 
## 
## Bootstrap Statistics :
##       original      bias    std. error
## t1* 0.00925212 0.001295651 0.004218273</code></pre>
</div>
<div id="section-5" class="section level2">
<h2>3.</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span>ci.bca<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  de<span class="ot">&lt;-</span><span class="fu">boot</span>(data,<span class="at">statistic =</span> mle_lambda,<span class="at">R=</span><span class="dv">999</span>)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(de,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  ci.bca[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;normal:&quot;</span>, <span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)  </span></code></pre></div>
<pre><code>## normal: -0.000513643 0.01637695</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;basic:&quot;</span>, <span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)  </span></code></pre></div>
<pre><code>## basic: -0.002946922 0.01327646</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;percentile:&quot;</span>, <span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)  </span></code></pre></div>
<pre><code>## percentile: 0.005227779 0.02145116</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bca:&quot;</span>, <span class="fu">mean</span>(ci.bca[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.bca[,<span class="dv">2</span>]), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## bca: 0.004561807 0.01806598</code></pre>
<p>由于时间间隔服从指数分布，并不是正态的，因此normal方法与basic方法不够准确；在这种分布下，percentile方法与bca方法较为准确，它们之间也比较接近。</p>
</div>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="section-6" class="section level2">
<h2>1.</h2>
<p>7.8</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span>scor</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>sort_eigen<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">eigen</span>(<span class="fu">cov</span>(df))<span class="sc">$</span>values, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> sort_eigen[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(sort_eigen)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df)  </span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>jackknife_estimates <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)  </span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {  </span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  leave_one_out <span class="ot">&lt;-</span> df[<span class="sc">-</span>i, ] </span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  sample_cov_matrix <span class="ot">&lt;-</span> <span class="fu">cov</span>(leave_one_out)  </span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>  eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sample_cov_matrix)<span class="sc">$</span>values  </span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>  sorted_eigenvalues <span class="ot">&lt;-</span> <span class="fu">sort</span>(eigenvalues, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>  jackknife_estimates[i] <span class="ot">&lt;-</span> sorted_eigenvalues[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(sorted_eigenvalues)  </span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>bias.jack<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(jackknife_estimates)<span class="sc">-</span>theta_hat)</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>se.jack<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((jackknife_estimates<span class="sc">-</span>theta_hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta_hat,<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
</div>
<div id="section-7" class="section level2">
<h2>2.</h2>
<p>7.10</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))  </span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">3</span>  </span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat4  </span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<p>由交叉验证结果可知，应该选择模型2</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>L2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>L3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> chemical)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>L4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">summary</span>(L1)<span class="sc">$</span>adj.r.squared,<span class="fu">summary</span>(L2)<span class="sc">$</span>adj.r.squared,<span class="fu">summary</span>(L3)<span class="sc">$</span>adj.r.squared,<span class="fu">summary</span>(L4)<span class="sc">$</span>adj.r.squared)</span></code></pre></div>
<pre><code>## [1] 0.5281545 0.5768151 0.5280556 0.5740396</code></pre>
<p>由adjusted <span class="math inline">\(R^2\)</span>结果可知，应该选择模型2</p>
</div>
<div id="section-8" class="section level2">
<h2>3.</h2>
<p>8.1</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>cvm_statistic <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {  </span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)  </span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)  </span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  Fn <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)  </span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  Gm <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)  </span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>  cvm <span class="ot">&lt;-</span> m<span class="sc">*</span>n<span class="sc">/</span>((m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(<span class="fu">sum</span>((<span class="fu">Fn</span>(x)<span class="sc">-</span><span class="fu">Gm</span>(x))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">sum</span>((<span class="fu">Fn</span>(y)<span class="sc">-</span><span class="fu">Gm</span>(y))<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cvm)  </span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co">#number of replicates</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co">#pooled sample</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co">#storage for replicates</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>cvm0 <span class="ot">&lt;-</span> <span class="fu">cvm_statistic</span>(x, y)</span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a><span class="co">#generate indices k for the first sample</span></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a>reps[i] <span class="ot">&lt;-</span> <span class="fu">cvm_statistic</span>(x1, y1)</span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">c</span>(cvm0,reps)<span class="sc">&gt;=</span>cvm0)</span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.414</code></pre>
<p>p值为0.414,因此拒绝原假设</p>
</div>
<div id="section-9" class="section level2">
<h2>4.</h2>
<p>8.2</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n)<span class="co"># x服从标准正态分布，y与x有一定的线性关系</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co">#pooled sample</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>n)</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co">#storage for replicates</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>rho0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="co">#generate indices k for the first sample</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>reps[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1,y1, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>) </span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(rho0,reps))<span class="sc">&gt;=</span><span class="fu">abs</span>(rho0))</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;原始Spearman秩相关系数:&quot;</span>, rho0, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)  </span></code></pre></div>
<pre><code>## 原始Spearman秩相关系数: 0.4439376</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;置换检验得到的p值:&quot;</span>, p, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)  </span></code></pre></div>
<pre><code>## 置换检验得到的p值: 0.002</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;cor.test函数得到的p值:&quot;</span>,<span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## cor.test函数得到的p值: 0.001378478</code></pre>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
<div id="section-10" class="section level2">
<h2>1、9.3</h2>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)  </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">1</span>  </span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="dv">0</span>     <span class="co"># Cauchy</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span>    <span class="co"># 生成样本的总数量</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span>   <span class="co"># 丢弃的前1000个样本</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)  <span class="co"># 初始化链的第一个样本</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>  candidate <span class="ot">&lt;-</span> samples[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, (<span class="fu">dcauchy</span>(candidate, <span class="at">location =</span> eta, <span class="at">scale =</span> theta)))</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> alpha) {</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>    samples[i] <span class="ot">&lt;-</span> candidate</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>    samples[i] <span class="ot">&lt;-</span> samples[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>  }<span class="co"># 接受或拒绝候选样本</span></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> samples[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n]<span class="co">#丢弃前1000个样本</span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>gene_qt <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))<span class="co">#产生的样本分位数</span></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>theo_qt <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">location =</span> eta, <span class="at">scale =</span> theta)<span class="co">#理论分位数</span></span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Decile =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Generated =</span> gene_qt,</span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Theoretical =</span> theo_qt)</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##     Decile  Generated Theoretical
## 10%    0.1 -1.3051588  -3.0776835
## 20%    0.2 -0.7282962  -1.3763819
## 30%    0.3 -0.4647887  -0.7265425
## 40%    0.4 -0.2030557  -0.3249197
## 50%    0.5  0.1008800   0.0000000
## 60%    0.6  0.4015867   0.3249197
## 70%    0.7  0.7852227   0.7265425
## 80%    0.8  1.3587765   1.3763819
## 90%    0.9  3.8769703   3.0776835</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>), gene_qt, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Decile&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Quantiles&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Comparison of Deciles&quot;</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>), theo_qt, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Generated&quot;</span>, <span class="st">&quot;Theoretical&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>观察图像可知，Metropolis-Hastings采样器产生的柯西分布样本的十分位数与理论值较为接近。</p>
</div>
<div id="section-11" class="section level2">
<h2>2、9.8</h2>
<p>选定a=2，b=3，n=10进行模拟</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span> </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">5000</span>  <span class="co"># 迭代次数</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>x_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>y_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>y_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># 初始化 y 值</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>iterations) {</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>  x_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> y_samples[i <span class="sc">-</span> <span class="dv">1</span>])<span class="co">#根据当前y值获得x</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>  y_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="at">shape1 =</span> x_samples[i] <span class="sc">+</span> a, <span class="at">shape2 =</span> n <span class="sc">-</span> x_samples[i] <span class="sc">+</span> b)<span class="co">#根据当前x值获得y</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>x_samples <span class="ot">&lt;-</span> x_samples[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iterations]</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>y_samples <span class="ot">&lt;-</span> y_samples[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iterations]<span class="co">#丢弃</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x_samples, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Gibbs&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Index&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Random numbers&quot;</span>,</span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">c</span>(x_samples, y_samples))) </span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y_samples, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>) </span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;x values&quot;</span>, <span class="st">&quot;y values&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-12" class="section level2">
<h2>3、</h2>
<p>9.3</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">5000</span>  </span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>num_chains <span class="ot">&lt;-</span> <span class="dv">3</span>    </span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>target_dist <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dcauchy</span>(x)  <span class="co">#标准柯西分布</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>MH_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(init, n_iter, <span class="at">proposal_sd =</span> <span class="dv">1</span>) {</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> init</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_iter) {</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>    proposal <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> x[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">sd =</span> proposal_sd)</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>    accept_prob <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, <span class="fu">target_dist</span>(proposal) <span class="sc">/</span> <span class="fu">target_dist</span>(x[i <span class="sc">-</span> <span class="dv">1</span>]))</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> accept_prob, proposal, x[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> iterations <span class="sc">-</span> burn_in, <span class="at">ncol =</span> num_chains)</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (chain <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_chains) {</span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>  init_value <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>) </span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>  full_chain <span class="ot">&lt;-</span> <span class="fu">MH_sampler</span>(init_value, iterations)</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>  chains[, chain] <span class="ot">&lt;-</span> full_chain[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iterations]  <span class="co"># 丢弃</span></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>mcmc_chains <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>num_chains, <span class="cf">function</span>(i) <span class="fu">mcmc</span>(chains[, i])))</span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>gelman_results <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(mcmc_chains)</span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gelman_results)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]       1.04       1.14</code></pre>
<p>观察结果可知此时链收敛</p>
<p>9.8</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>  </span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span>  </span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>  </span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">5000</span>  </span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span>   </span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>num_chains <span class="ot">&lt;-</span> <span class="dv">3</span>   </span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>x_chains <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> iterations <span class="sc">-</span> burn_in, <span class="at">ncol =</span> num_chains)</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>y_chains <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> iterations <span class="sc">-</span> burn_in, <span class="at">ncol =</span> num_chains)</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (chain <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_chains) {</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>  x_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>  y_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>  y_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span> </span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>iterations) {</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>    x_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> y_samples[i <span class="sc">-</span> <span class="dv">1</span>])<span class="co">#根据当前y值获得x</span></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>    y_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="at">shape1 =</span> x_samples[i] <span class="sc">+</span> a, <span class="at">shape2 =</span> n <span class="sc">-</span> x_samples[i] <span class="sc">+</span> b)<span class="co">#根据当前x值获得y</span></span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>  x_chains[, chain] <span class="ot">&lt;-</span> x_samples[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iterations]</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>  y_chains[, chain] <span class="ot">&lt;-</span> y_samples[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iterations]</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>x_mcmc <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>num_chains, <span class="cf">function</span>(i) <span class="fu">mcmc</span>(x_chains[, i])))</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>y_mcmc <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>num_chains, <span class="cf">function</span>(i) <span class="fu">mcmc</span>(y_chains[, i])))</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>gelman_x <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(x_mcmc)</span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>gelman_y <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(y_mcmc)</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gelman_x)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1       1.01</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gelman_y)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1       1.01</code></pre>
<p>观察结果可知此时链收敛</p>
</div>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
<div id="section-13" class="section level2">
<h2>1、</h2>
<p>11.3</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;pracma&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     logit</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(base)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>kth_term <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a, d) {<span class="co">#计算第k个式子</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  norm_a<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))<span class="co">#欧式范数</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  numerator<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span>(<span class="fu">factorial</span>(k)<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>k)<span class="sc">*</span>(norm_a)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))<span class="co">#前两项乘积</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  gamma_factor<span class="ot">&lt;-</span><span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">gamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)<span class="co">#第三项</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  term <span class="ot">&lt;-</span> numerator<span class="sc">*</span> gamma_factor</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(term)</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>sum_series <span class="ot">&lt;-</span> <span class="cf">function</span>(a,d,<span class="at">tol=</span><span class="fl">1e-10</span>) {<span class="co">#求和</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>  sum<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span> {</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>    term<span class="ot">&lt;-</span><span class="fu">kth_term</span>(k, a, d)</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>    sum<span class="ot">&lt;-</span>sum<span class="sc">+</span>term</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(term)<span class="sc">&lt;</span>tol) <span class="cf">break</span></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>    k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sum)</span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">length</span>(a)</span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_series</span>(a, d)<span class="co">#给定a=(1,2)^T时求和结果</span></span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
</div>
<div id="section-14" class="section level2">
<h2>2、11.5</h2>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>c_k<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>k)<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>LHS<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){<span class="co">#等号左边</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  ck_1<span class="ot">&lt;-</span><span class="fu">c_k</span>(a,k<span class="dv">-1</span>)</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.nan</span>(ck_1) <span class="sc">||</span> ck_1 <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)  <span class="co"># 返回 NA 以避免无效积分</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  integrand<span class="ot">&lt;-</span><span class="cf">function</span>(u){<span class="co">#积分项</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span><span class="sc">+</span>(u<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(k<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>k<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>  integral_result<span class="ot">&lt;-</span><span class="fu">integrate</span>(integrand,<span class="dv">0</span>,ck_1)<span class="sc">$</span>value</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">2</span><span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="fu">sqrt</span>(pi<span class="sc">*</span>(k<span class="dv">-1</span>))<span class="sc">*</span><span class="fu">gamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span>integral_result</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>RHS<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){<span class="co">#等号右边</span></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>  ck<span class="ot">&lt;-</span><span class="fu">c_k</span>(a, k)</span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.nan</span>(ck) <span class="sc">||</span> ck <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)  <span class="co"># 返回 NA 以避免无效积分</span></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>  integrand<span class="ot">&lt;-</span><span class="cf">function</span>(u){<span class="co">#积分项</span></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span><span class="sc">+</span>(u<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a>  integral_result<span class="ot">&lt;-</span><span class="fu">integrate</span>(integrand,<span class="dv">0</span>,ck)<span class="sc">$</span>value</span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">2</span><span class="sc">*</span><span class="fu">gamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="fu">sqrt</span>(pi<span class="sc">*</span>k)<span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span>integral_result</span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a>objective_function<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){<span class="co">#差值函数，越接近0说明LHS与RHS越接近</span></span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">LHS</span>(a,k)<span class="sc">-</span><span class="fu">RHS</span>(a,k)</span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a>find_intersection<span class="ot">&lt;-</span><span class="cf">function</span>(k){</span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>({</span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">optimize</span>(<span class="cf">function</span>(a) {<span class="co">#寻找一个使得差值函数绝对值最接近0的值</span></span>
<span id="cb135-33"><a href="#cb135-33" aria-hidden="true" tabindex="-1"></a>  obj_val <span class="ot">&lt;-</span> <span class="fu">objective_function</span>(a,k)</span>
<span id="cb135-34"><a href="#cb135-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(obj_val)) <span class="fu">return</span>(<span class="cn">Inf</span>)  <span class="co">#如果值为NA,返回无穷大，表示不适合的解</span></span>
<span id="cb135-35"><a href="#cb135-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(obj_val)</span>
<span id="cb135-36"><a href="#cb135-36" aria-hidden="true" tabindex="-1"></a>}, <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fu">sqrt</span>(k)))</span>
<span id="cb135-37"><a href="#cb135-37" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb135-38"><a href="#cb135-38" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(result<span class="sc">$</span>minimum)</span>
<span id="cb135-39"><a href="#cb135-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-40"><a href="#cb135-40" aria-hidden="true" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb135-41"><a href="#cb135-41" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sapply</span>(k_values, find_intersection)</span>
<span id="cb135-42"><a href="#cb135-42" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(k_values,results)</span></code></pre></div>
<pre><code>##              [,1]      [,2]       [,3]      [,4]      [,5]
## k_values 4.000000 25.000000 100.000000 500.00000 1000.0000
## results  1.492084  4.855902   7.784183  22.36064   31.6227</code></pre>
<p>结果展示了当k分别取4,25,100,500,1000时，满足方程的a的近似解。</p>
<p>与11.4中的A(k)比较：</p>
<p>11.4</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>S_k_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  threshold<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pt</span>(threshold, <span class="at">df=</span>k<span class="dv">-1</span>,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>S_k <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  threshold<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pt</span>(threshold, <span class="at">df =</span> k, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>objective_function <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {<span class="co">#差值函数</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">S_k_1</span>(a, k)<span class="sc">-</span><span class="fu">S_k</span>(a, k)</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>find_intersection <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {<span class="co">#求根</span></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">uniroot</span>(<span class="cf">function</span>(a) <span class="fu">objective_function</span>(a, k), <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fu">sqrt</span>(k) <span class="sc">-</span> <span class="fl">0.01</span>))<span class="sc">$</span>root</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA</span>)  </span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sapply</span>(k_values, find_intersection)</span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(k_values,results)</span></code></pre></div>
<pre><code>##              [,1]      [,2]       [,3]      [,4]       [,5]
## k_values 4.000000 25.000000 100.000000 500.00000 1000.00000
## results  1.492073  1.687366   1.720607  22.35068   31.61278</code></pre>
<p>经过比较可知，11.5中方程的近似解与11.4中A(k)的值近似相等。</p>
</div>
<div id="section-15" class="section level2">
<h2>3、</h2>
<p>由于<span class="math inline">\(T_i\sim
exp(\lambda)\)</span>，所以<span class="math inline">\(f_{T_i}(t)=\lambda e^{-\lambda t}\)</span>，因此
<span class="math display">\[f_{T_i|T_i&gt;\tau}(t)=\frac{f_{T_i}(t)}{P(T_i&gt;\tau)}=\frac{\lambda
e^{-\lambda t}}{e^{-\lambda \tau}}=\lambda e^{-\lambda
(t-\tau)}\]</span> 观察概率密度函数可知这是一个偏移的条件分布，因此
<span class="math display">\[E(T_i|T_i&gt;\tau)=\tau+\frac{1}{\lambda}\]</span>
因此更新后的<span class="math inline">\(\lambda\)</span>为 <span class="math display">\[\lambda_{new}=\frac{n}{\sum[T_i
I(T_i&lt;\tau)+E(T_i|T_i&gt;\tau)I(T_i&gt;\tau)]}\]</span></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>,<span class="fl">0.91</span>,<span class="fl">1.00</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>tau<span class="ot">&lt;-</span><span class="dv">1</span> </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">1</span>  <span class="co">#给定的初始λ值</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(data)</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>max_iter<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>tol<span class="ot">&lt;-</span><span class="fl">1e-6</span>  </span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {<span class="co">#EM算法</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>  expected_censored<span class="ot">&lt;-</span><span class="fu">sum</span>((data<span class="sc">==</span>tau)<span class="sc">*</span>(tau<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>lambda))<span class="co">#E步,计算T_i&gt;tau时T_i的期望值</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>  lambda_new<span class="ot">&lt;-</span>n<span class="sc">/</span>(<span class="fu">sum</span>(data[data<span class="sc">&lt;</span>tau])<span class="sc">+</span>expected_censored)<span class="co">#M步</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">abs</span>(lambda_new<span class="sc">-</span>lambda)<span class="sc">&lt;</span>tol){</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>    lambda<span class="ot">&lt;-</span>lambda_new</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span>lambda_new</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>lambda_mle<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(data)<span class="co">#MLE</span></span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>lambda</span></code></pre></div>
<pre><code>## [1] 1.037037</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>lambda_mle</span></code></pre></div>
<pre><code>## [1] 1.481481</code></pre>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="section-16" class="section level2">
<h2>1、11.7</h2>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co">#for simplex function</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">maxi =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Linear Programming Results
## 
## Call : simplex(a = a, A1 = A1, b1 = b1, maxi = FALSE)
## 
## Minimization Problem with Objective Function Coefficients
## x1 x2 x3 
##  4  2  9 
## 
## 
## Optimal solution has the following values
## x1 x2 x3 
##  0  0  0 
## The optimal value of the objective  function is 0.</code></pre>
<p>因此当<span class="math inline">\(x=y=z=0\)</span>时，<span class="math inline">\(4x+2y+9z\)</span>有最小值0</p>
</div>
<div id="advanced-r-p204-3" class="section level2">
<h2>2、advanced R P204 3</h2>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>for_loops<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(formulas)) {<span class="co">#使用for循环</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>  for_loops[[i]]<span class="ot">&lt;-</span><span class="fu">lm</span>(formulas[[i]],<span class="at">data =</span> mtcars)</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>for_loops</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(formulas, <span class="cf">function</span>(formula) <span class="fu">lm</span>(formula,<span class="at">data =</span> mtcars))<span class="co">#使用lappy函数</span></span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="advanced-r-p204-4" class="section level2">
<h2>3、advanced R P204 4</h2>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>mtcars[rows, ]</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>for_loops<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(bootstraps)) {<span class="co">#使用for循环</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>  for_loops[[i]]<span class="ot">&lt;-</span><span class="fu">lm</span>(mpg<span class="sc">~</span>disp,<span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>for_loops</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.83577     -0.04923  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.43227     -0.03332  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.2985      -0.0383  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     30.4626      -0.0481  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.22472     -0.04374  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.65286     -0.03361  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     27.9432      -0.0348  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.85766     -0.03859  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.92968     -0.04381  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.02797     -0.04598</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(bootstraps, <span class="cf">function</span>(boo) <span class="fu">lm</span>(mpg<span class="sc">~</span>disp,<span class="at">data =</span> boo))<span class="co">#使用lappy函数</span></span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boo)
## 
## Coefficients:
## (Intercept)         disp  
##    31.83577     -0.04923  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boo)
## 
## Coefficients:
## (Intercept)         disp  
##    27.43227     -0.03332  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boo)
## 
## Coefficients:
## (Intercept)         disp  
##     28.2985      -0.0383  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boo)
## 
## Coefficients:
## (Intercept)         disp  
##     30.4626      -0.0481  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boo)
## 
## Coefficients:
## (Intercept)         disp  
##    30.22472     -0.04374  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boo)
## 
## Coefficients:
## (Intercept)         disp  
##    26.65286     -0.03361  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boo)
## 
## Coefficients:
## (Intercept)         disp  
##     27.9432      -0.0348  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boo)
## 
## Coefficients:
## (Intercept)         disp  
##    28.85766     -0.03859  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boo)
## 
## Coefficients:
## (Intercept)         disp  
##    30.92968     -0.04381  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boo)
## 
## Coefficients:
## (Intercept)         disp  
##    31.02797     -0.04598</code></pre>
</div>
<div id="advanced-r-p204-5" class="section level2">
<h2>4、advanced R P204 5</h2>
<p>第三题：</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>for_loops<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>r_for<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(formulas))</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(formulas)) {<span class="co">#使用for循环</span></span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>  for_loops[[i]]<span class="ot">&lt;-</span><span class="fu">lm</span>(formulas[[i]],<span class="at">data =</span> mtcars)</span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>  r_for[i]<span class="ot">&lt;-</span><span class="fu">rsq</span>(for_loops[[i]])</span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>r_for</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>la<span class="ot">&lt;-</span><span class="cf">function</span>(formula){</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  mod<span class="ot">&lt;-</span><span class="fu">lm</span>(formula,<span class="at">data =</span> mtcars)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rsq</span>(mod)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(formulas,la)<span class="co">#使用lappy函数</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<p>第四题：</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>mtcars[rows, ]</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>for_loops<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>r_for<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(bootstraps))</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(bootstraps)) {<span class="co">#使用for循环</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>  for_loops[[i]]<span class="ot">&lt;-</span><span class="fu">lm</span>(mpg<span class="sc">~</span>disp,<span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>  r_for[i]<span class="ot">&lt;-</span><span class="fu">rsq</span>(for_loops[[i]])</span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>r_for</span></code></pre></div>
<pre><code>##  [1] 0.7581307 0.6648491 0.7083818 0.7564927 0.7663934 0.7073677 0.6834533
##  [8] 0.6875879 0.6417534 0.7445065</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>la<span class="ot">&lt;-</span><span class="cf">function</span>(boo){</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  mod<span class="ot">&lt;-</span><span class="fu">lm</span>(mpg<span class="sc">~</span>disp,<span class="at">data =</span> boo)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rsq</span>(mod)</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(bootstraps, la)<span class="co">#使用lappy函数</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7581307
## 
## [[2]]
## [1] 0.6648491
## 
## [[3]]
## [1] 0.7083818
## 
## [[4]]
## [1] 0.7564927
## 
## [[5]]
## [1] 0.7663934
## 
## [[6]]
## [1] 0.7073677
## 
## [[7]]
## [1] 0.6834533
## 
## [[8]]
## [1] 0.6875879
## 
## [[9]]
## [1] 0.6417534
## 
## [[10]]
## [1] 0.7445065</code></pre>
</div>
<div id="advanced-r-p213-3" class="section level2">
<h2>5、advanced R P213 3</h2>
<p>使用sapply和匿名函数</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span>,</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(trials,<span class="cf">function</span>(x) x<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.92573839 0.38341791 0.21070462 0.41458918 0.26121206 0.72223937
##   [7] 0.29887169 0.95162894 0.26398664 0.62018151 0.51388383 0.94676108
##  [13] 0.05206634 0.94395869 0.90872276 0.91948631 0.66419598 0.29837025
##  [19] 0.29940554 0.83506207 0.45274078 0.90320828 0.79263778 0.45399170
##  [25] 0.38923722 0.69542630 0.26739653 0.38567329 0.31137487 0.36010634
##  [31] 0.39754771 0.72253407 0.42186171 0.12771643 0.23170443 0.68265125
##  [37] 0.71252902 0.12724649 0.75353630 0.94884686 0.87276882 0.41388298
##  [43] 0.25224053 0.84404036 0.16580146 0.42473329 0.82280924 0.71272703
##  [49] 0.30947058 0.92816784 0.27134690 0.62008647 0.49758173 0.02775463
##  [55] 0.78775614 0.26248714 0.77273771 0.68416168 0.08687832 0.04574362
##  [61] 0.44178950 0.36827740 0.64265435 0.47847663 0.10832740 0.75695184
##  [67] 0.61642417 0.01474650 0.18023871 0.42316145 0.38702375 0.27030894
##  [73] 0.92266032 0.75504614 0.65781938 0.34910615 0.22083614 0.53165720
##  [79] 0.14727409 0.50490437 0.42920650 0.71256710 0.72931439 0.90676814
##  [85] 0.85988192 0.87366680 0.91047506 0.99255659 0.15198012 0.09537499
##  [91] 0.37213020 0.96151424 0.97595090 0.30669922 0.42738809 0.75571001
##  [97] 0.15155800 0.06214524 0.29324608 0.83599679</code></pre>
<p>直接用[[</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span>,</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="st">&#39;[[&#39;</span>,<span class="st">&quot;p.value&quot;</span>)</span></code></pre></div>
<pre><code>##   [1] 0.92573839 0.38341791 0.21070462 0.41458918 0.26121206 0.72223937
##   [7] 0.29887169 0.95162894 0.26398664 0.62018151 0.51388383 0.94676108
##  [13] 0.05206634 0.94395869 0.90872276 0.91948631 0.66419598 0.29837025
##  [19] 0.29940554 0.83506207 0.45274078 0.90320828 0.79263778 0.45399170
##  [25] 0.38923722 0.69542630 0.26739653 0.38567329 0.31137487 0.36010634
##  [31] 0.39754771 0.72253407 0.42186171 0.12771643 0.23170443 0.68265125
##  [37] 0.71252902 0.12724649 0.75353630 0.94884686 0.87276882 0.41388298
##  [43] 0.25224053 0.84404036 0.16580146 0.42473329 0.82280924 0.71272703
##  [49] 0.30947058 0.92816784 0.27134690 0.62008647 0.49758173 0.02775463
##  [55] 0.78775614 0.26248714 0.77273771 0.68416168 0.08687832 0.04574362
##  [61] 0.44178950 0.36827740 0.64265435 0.47847663 0.10832740 0.75695184
##  [67] 0.61642417 0.01474650 0.18023871 0.42316145 0.38702375 0.27030894
##  [73] 0.92266032 0.75504614 0.65781938 0.34910615 0.22083614 0.53165720
##  [79] 0.14727409 0.50490437 0.42920650 0.71256710 0.72931439 0.90676814
##  [85] 0.85988192 0.87366680 0.91047506 0.99255659 0.15198012 0.09537499
##  [91] 0.37213020 0.96151424 0.97595090 0.30669922 0.42738809 0.75571001
##  [97] 0.15155800 0.06214524 0.29324608 0.83599679</code></pre>
</div>
<div id="advanced-r-p214-6" class="section level2">
<h2>6、advanced R P214 6</h2>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>lapply1<span class="ot">&lt;-</span><span class="cf">function</span>(fun,...,fun.value){<span class="co">#lapply函数的variant</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  inputs<span class="ot">&lt;-</span><span class="fu">list</span>(...)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  res<span class="ot">&lt;-</span><span class="fu">Map</span>(fun,...)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vapply</span>(res,identity,<span class="at">FUN.VALUE =</span> fun.value)</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="co">#举例，输入三个列表，计算它们对应元素的和，并以向量的形式返回</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>)</span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>)</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>add<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,c){</span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>  a<span class="sc">+</span>b<span class="sc">+</span>c</span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply1</span>(add,x,y,z,<span class="at">fun.value =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1]  8 12 16 20</code></pre>
<p>由函数的定义及例子可知，该函数应该采用三个参数：
1、fun：应用于输入列表的函数 2、…：多个输入列表
3、fun.value：指定返回值的类型和长度</p>
</div>
<div id="advanced-r-p365-4" class="section level2">
<h2>7、advanced R P365 4</h2>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>chisq_quick<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  x_lev<span class="ot">&lt;-</span><span class="fu">unique</span>(x)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  y_lev<span class="ot">&lt;-</span><span class="fu">unique</span>(y)</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  obs<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="fu">length</span>(x_lev),<span class="at">ncol =</span> <span class="fu">length</span>(y_lev))</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>    x_index<span class="ot">&lt;-</span><span class="fu">which</span>(x_lev<span class="sc">==</span>x[i])</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>    y_index<span class="ot">&lt;-</span><span class="fu">which</span>(y_lev<span class="sc">==</span>y[i])</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>    obs[x_index,y_index]<span class="ot">&lt;-</span>obs[x_index,y_index]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>  exp<span class="ot">&lt;-</span><span class="fu">outer</span>(<span class="fu">rowSums</span>(obs),<span class="fu">colSums</span>(obs))<span class="sc">/</span><span class="fu">sum</span>(obs)</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>  chi<span class="ot">&lt;-</span><span class="fu">sum</span>((obs<span class="sc">-</span>exp)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>exp)</span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(chi)</span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="advanced-r-p365-5" class="section level2">
<h2>8、advanced R P365 5</h2>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>chisq_quick1<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>  obs<span class="ot">&lt;-</span><span class="fu">table</span>(x,y)</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  exp<span class="ot">&lt;-</span><span class="fu">outer</span>(<span class="fu">rowSums</span>(obs),<span class="fu">colSums</span>(obs))<span class="sc">/</span><span class="fu">sum</span>(obs)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>  chi<span class="ot">&lt;-</span><span class="fu">sum</span>((obs<span class="sc">-</span>exp)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>exp)</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(chi)</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="co">#举例比较</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="fl">1e6</span>,<span class="at">replace =</span> T)</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="fl">1e6</span>,<span class="at">replace =</span> T)</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">chisq_quick</span>(a,b))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.92    0.00    3.42</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">chisq_quick1</span>(a,b))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.04    0.00    0.08</code></pre>
<p>由结果可知table()版本的卡方检验速度显著提升了</p>
</div>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
<div id="用rcpp实现" class="section level2">
<h2>1、用Rcpp实现</h2>
<p>取n=10，a=3，b=5</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RcppArmadillo)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SA24204177)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>out<span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>res_rcpp<span class="ot">&lt;-</span><span class="fu">Gibbs</span>(n,a,b,N,out)</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res_rcpp[,<span class="dv">1</span>],res_rcpp[,<span class="dv">2</span>],<span class="at">pch=</span><span class="dv">20</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>),<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Rcpp&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAolBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZrYBAf8DA/8HB/8PD/8fH/86AAA6ADo6AGY6OgA6OmY6ZpA6ZrY6kLY6kNs/P/9mAABmADpmOjpmZmZmkNtmtttmtv9/f/+QOgCQZgCQZjqQttuQ2/+2ZgC2kDq227a229u22/+2/7a2/9u2///bkDrbtmbb/9vb////tmb/25D/27b//7b//9v///8GBq7ZAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKW0lEQVR4nO2d7WKbNhSGabImcd10azfH+2qztd6WLXQhc3z/tzYE2IEjS69AEgjnff7UFFkRT6SDJCSS7YiVbOoCpA4FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQESEnQ021W8er93dRFeSZFQaWiL1OX5UCagrLLqctyIDFBFw/lv4/X9b9fv8uyb34tP2yysz9/yrLXd+LzGKQoqJSg/t3UlWl1+FS1vM3IrTBFQXUNKrLsh4f/1tnZvZJydrf7WrW89ucxSEzQnlXVlu53u/zDX5WUj7vmf9qfxyBNQZcPz+1td7CRq3bV/jwGKQp6/bk+ODSiRkqhKk/78xgkJuji4emPrKo6rEE6jZO8DsC1ieL9Z8agPftKUzsoG9H3D6rVfeRdrKF1m1fVY3PoVO/7Pq3/HasCJSlISVD1o+pJ/1Idn/3ze5Z9uBOfxyAlQUbaAWe04NNAQQAKAlAQYBaCpoSCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQECCwomw1TCQqbXTxesKCbmxuHVC9X0M2nT58cDFEQ4IQFgSYkBcnkzfHIgvrfHAaj1RCDAUPy/fEp1SC3KzZ9+fQFiUukIAkIKqjJpRGDYmWncIy6puQGTkgQiEFa6pcnqAtsUhQkWtzbt287QpbLZSf98W7T6QqSApalgfZ/yJue9NdwuoJkDQKC5Ok9cxLkNvw+pAZN7PQEwbFDz+Tipnd1dTXzJga7xjLodA+Bz+VSpq+ZsyDRZkQj0ZIbqsjxb/cv6PSCZBWQlyTqgBRyrth105u/3b+gCQgSyBq0KI8Xz4fn5QW3hUhB0uebN29GjEGbs3u1adv81oMQgmQb6l7ioqxBLV+aoEWZvHXe1LGOI6jy866Us10bXpwRokLKsUO3Rp0vFgtbDRLHowrarlelpOqNB/nhvRrDs3NE1KBlef3toAIEaTe9hkiCPu6eblfqY2HYWRtBkAgqWgySNap7PHITK2tPPnYNEkFnUVaQdgzSjqeMQdv12X1VhQpTlHbKDowtRKMQbUZrQqLJiRY5rqDqlSwK45tXXLIDU4SyHyTajKwxWk8QdLx7FLRfwnDZgVl4ecWiiYF+j7zpjV2DQmSHBIkrFm1ICropDy1fn2o+KPe5i4EHXWIsIQWVpzsdQ3uQTmQs5vVkVcYgUYNEDEL9HiHsBGcUwVhC1piUetLjZAfGElCQ+Pq4k/b7Nx0a31ATogZ1gwjqB4HBqok4gnL1ClFFsf/glV1D+StvHy7LY8tgCwkyzW8MLWifK2rGYYqAQw35K5f3bSBINrkpl+C1Jjm8BqvdS5BBAwQZraMoKpwjKdcgcWNBbabnWMyRWDGoqUJeMUjOgPkJ0uak3Yh0F9uu67uYof4YspM9wW6jCC0IrWFMb32Q7KuJICPHDp6CHFecTSoILEg5L29bw7vGfQUZCjOlIPSoVHaNwWOKnkHacUljSoLkL1FUGdAxREMN7S4mpocMhUlZkLikno8ptI6iqICgBrUL6sQUMajf/IUUJGO6HJyKocYMVpiBGBT4Ni+eVPcpqF/C4dnJOauwgrSYZFit4FBQv4TDs9NWI9hn4T1rkGmO1aGgfgmHZ6fNyp9bZ+GRIPBs3vScx6GgfgmHZ6f1pL1qEOpXehTUnrAcZgX4QwwuYzE51PAThOaDAt7F8iwzDdKdcfm5gYO0nG+L+ujZ29GxfpAkrCDZz4y9eCG3Tcm7ZYd60oFrkBzKdZfHhBWkliaoJUDG6R6n7HoOVgM3Ma3JBYtBajKsNmOacHbMDq3r9ROkBWnRc472VGO79vh7VN1Hz+hZctAaJB+CzLAfBIbrvkFaLn+Z336xnldMQYGDtIxBL12QXD6kBeX5vdwksCA5IeZWY1wK6pdweHZhg7Q239NvP56toH4Jh2cXWVC4gvolHJ5dz9UI4FgOLQIW1C9hj+zk2Mv+6NRX0PyaGBh7+QqSY635BenIgkSDnaMg++C0t6BuC6UgeSxGo3LSnjFIPMeRpz0KGjahe3ZoX3LfGtTNLu3bfJ41f+bdtlcj8IIfYSTpjmL+6stuu1ZPh2yCxAIp7yAt9li6zRgiIq5yraasrYLCrqmTs/CG3Sk9ibpOenPxMGITE0O5gbf1YwUNm3DXWie9ubQJChykZyTo0LC2a9OzM5UdmKT3DNID+z3HCho2YcV+JfnTrU3QudeaOu1YhLQwTNkPCh2kw/QMjxQ0bEL37Hpe8WkKst7mwwoK1HU+UtCwCe25tJ+s+goSLXTgfidU4uAJ3bPr+QIbeRpshA9Y0LAJ3bPzvItpS8TCjC2OFDRswgqnTb2emy/QuzzCEKmj6LSp11OQ9ubI+dQgxy2ZnkFaewvefGqQ46bewIICDd+PFDRswt1YNQi8nDUQsWKQy6benoLgErEwo9MjBQ2bsMJpU29fQaPUGMmMxmIDl4h5QkGAGQuKE3MkSQ81uqPROGMtxJSCZE9aW/rdPR+np4yYVJAQom277U7qx+kpI1Ka7tC2/os3HUbpKSOSmpMWT1odd7bHJakYZN/6P85dSzLpGkXxUjJtJ/skRgQpLeKUwpIgpQVUSUJBAAoCJBWDUmRSQXOAggCTCZoNEwlyyxSc9zvt+3W/5GEypSC/8xREQX7nKYiC/M5TEAX5nT99QacEBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAoQXVGSZ7a2w1Y6qlTWHjeVtxI/Xlj+kvGu9XeTol7+9dyhhl+CC1N/JNv6tbOWnPJdbr7EwL+TfFeWp+u0hx1FvFylMhtTf8sYlFIQWVG942Rgv4fFald60J1ixXZsF1bmbv/10e2n+6UW9ERCVUBBaEBagsP0C84vfjIIe39l/8TZBRbaqNnG5lfBAcEHVJaBXdm/M58sMzDGoOPt7bY1g1iZWF8uthAdCC6rrBmjixt1UdQMwC8pVI6mriTFrSwCurDiV8JkpBBWWGK126lkEvQK/fVU1H69Xph+cgCCHCmypP/XXLYKqfOsocvTr9viSQhPDITC3xpBmcYrBQH1Z5lANakcKQRreRHNzP26PuQbV24rNv/364o3niwRu86gbZg4Qz1h60ipEtfYW61/FMWjijmLVSmy9nLoJWctnG2oUYKCysZ1vqpa9hAIOVgEUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYDUBamVYNv1aroCpC5IrZYy/QmGUUhdkFoa/aPzaqcIJC9ot7Fu7IhO+oLMC+dHIXlBT7c/u67YjULygvKLfy2rWuOTuiC1Mtp5VXwMUhe0qRZGTximUxc0ORQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEOB/rxrziR118rIAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="用r实现" class="section level2">
<h2>2、用R实现</h2>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>gibbs_r<span class="ot">&lt;-</span><span class="cf">function</span>(n,a,b,N,out){</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>  res_rx<span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>  res_ry<span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>  res_ry[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>    res_rx[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,res_ry[i<span class="dv">-1</span>])</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>    res_ry[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,res_rx[i]<span class="sc">+</span>a,n<span class="sc">-</span>res_rx[i]<span class="sc">+</span>b)</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(res_rx,res_ry)</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>res_r<span class="ot">&lt;-</span><span class="fu">gibbs_r</span>(n,a,b,N,out)</span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a><span class="co">#比较x</span></span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(res_rcpp[, <span class="dv">1</span>],res_r[,<span class="dv">1</span>], </span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Rcpp Samples&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R Samples&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co">#比较y</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(res_rcpp[, <span class="dv">2</span>],res_r[,<span class="dv">2</span>], </span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Rcpp Samples&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R Samples&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="比较运行时间" class="section level2">
<h2>3、比较运行时间</h2>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(<span class="at">Rcpp=</span><span class="fu">Gibbs</span>(n,a,b,N,out),<span class="at">R=</span><span class="fu">gibbs_r</span>(n,a,b,N,out))</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq  median     uq
## 1 Rcpp  343.60  358.25  373.3
## 2    R 3884.25 3977.35 4965.9</code></pre>
</div>
<div id="评论" class="section level2">
<h2>4、评论</h2>
<p>根据结果可以看出，Rcpp函数所需运行时间显著小于R函数，因此Rcpp函数具有更好的性能。</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
